---
title: Tag Reference
description: Complete reference for sanitization struct tags
author: zoobzio
published: 2025-12-27
updated: 2025-12-27
tags:
  - Reference
  - Tags
  - Sanitization
---

# Tag Reference

Sanitization is configured through struct tags. Tags are processed in order of precedence.

## Tag Precedence

When multiple sanitization tags are present, the first matching tag is applied:

1. `encrypt` - Reversible encryption
2. `hash` - One-way hash
3. `redact` - Full replacement
4. `mask` - Partial masking

```go
// encrypt is applied, hash is ignored
Field string `encrypt:"pii" hash:"sha256"`
```

## encrypt

Encrypts the field value. Decrypted on unmarshal.

```go
type User struct {
    Password string `json:"password" encrypt:"pii"`
}
```

**Tag value:** Key for registered encryptor (via `WithEncryptor`)

**Behavior:**
- String fields: encrypt → base64 encode → store
- On unmarshal: base64 decode → decrypt → restore

**Registration required:**

```go
enc, _ := codec.AES(key)
codec.NewSerializer[User](json.New(), codec.WithEncryptor("pii", enc))
```

**Error if missing:** Serializer creation fails if tag references unregistered encryptor.

## hash

One-way cryptographic hash. Not reversible.

```go
type User struct {
    Token string `json:"token" hash:"sha256"`
}
```

**Tag value:** Key for registered hasher (via `WithHasher`)

**Behavior:**
- Hash field value
- Store hex-encoded result
- On unmarshal: value remains hashed

**Registration required:**

```go
codec.NewSerializer[User](json.New(), codec.WithHasher("sha256", codec.SHA256()))
```

**Available hashers:**

| Tag Value | Function |
|-----------|----------|
| Any custom key | `codec.SHA256()` |
| Any custom key | `codec.SHA512()` |

## redact

Replaces entire value with mask string. Not reversible.

```go
type Note struct {
    Content string `json:"content" redact:"[REDACTED]"`
    Secret  string `json:"secret" redact:"***"`
}
```

**Tag value:** Replacement string

**Behavior:**
- Replace field value with tag value
- On unmarshal: value remains replaced

**No registration required.** Tag value is used directly as replacement.

## mask

Content-aware partial masking. Not reversible.

```go
type Customer struct {
    Email string `json:"email" mask:"email"`
    SSN   string `json:"ssn" mask:"ssn"`
}
```

**Tag value:** Built-in mask type

**Available mask types:**

| Tag Value | Input | Output |
|-----------|-------|--------|
| `ssn` | `123-45-6789` | `***-**-6789` |
| `email` | `alice@example.com` | `a***@example.com` |
| `phone` | `(555) 123-4567` | `(***) ***-4567` |
| `card` | `4111111111111111` | `************1111` |
| `ip` | `192.168.1.100` | `192.168.xxx.xxx` |
| `uuid` | `550e8400-e29b-...` | `550e8400-****-...` |
| `iban` | `GB82WEST...5432` | `GB82****...5432` |
| `name` | `John Smith` | `J*** S****` |

**No registration required.** Built-in maskers are always available.

**Error if unknown:** Serializer creation fails if tag references unknown mask type.

## Field Type Support

| Tag | String | []byte |
|-----|--------|--------|
| `encrypt` | Yes | Yes |
| `hash` | Yes | Yes |
| `redact` | Yes | No |
| `mask` | Yes | No |

## Combining with Format Tags

Sanitization tags work alongside format tags:

```go
type User struct {
    // JSON field name + encryption
    Password string `json:"password" encrypt:"pii"`

    // XML field name + masking
    Email string `xml:"email" mask:"email"`

    // YAML field name + redaction
    Note string `yaml:"note" redact:"[HIDDEN]"`
}
```

## Nested Structs

Current implementation does not traverse nested structs. Sanitization applies only to direct fields of the serialized type.

```go
type Address struct {
    Street string `json:"street" redact:"***"` // NOT processed
}

type User struct {
    Name    string  `json:"name" mask:"name"`  // Processed
    Address Address `json:"address"`           // Nested fields not processed
}
```

For nested sanitization, implement `Sanitizable` and `Desanitizable` interfaces.

## Validation

Serializer creation validates all tags:

```go
type User struct {
    Password string `encrypt:"unknown"` // Unknown encryptor
}

ser, err := codec.NewSerializer[User](json.New())
// err: missing encryptor for tag value "unknown"
```

Validation checks:
- `encrypt` tag values have registered encryptors
- `hash` tag values have registered hashers
- `mask` tag values are valid built-in types
- `redact` tag values are non-empty strings
