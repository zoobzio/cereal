---
title: Overview
description: Boundary-aware serialization for Go
author: zoobzio
published: 2025-12-27
updated: 2025-12-27
tags:
  - Overview
  - Introduction
---

# Overview

Data crosses boundaries constantly. Each crossing demands different treatment.

Cereal provides boundary-aware serialization: transform data differently depending on where it's going or where it came from.

```go
type User struct {
    ID       string `json:"id"`
    Email    string `json:"email" store.encrypt:"aes" load.decrypt:"aes" send.mask:"email"`
    Password string `json:"password" receive.hash:"argon2"`
    SSN      string `json:"ssn" send.mask:"ssn"`
    Token    string `json:"token" send.redact:"[REDACTED]"`
}

func (u User) Clone() User { return u }

func main() {
    ctx := context.Background()

    proc, _ := cereal.NewProcessor[User](json.New())
    enc, _ := cereal.AES(key)
    proc.SetEncryptor(cereal.EncryptAES, enc)

    // Receive: hash password from incoming request
    user, _ := proc.Receive(ctx, requestBody)

    // Store: encrypt email before saving to database
    data, _ := proc.Store(ctx, user)

    // Load: decrypt email when reading from database
    loaded, _ := proc.Load(ctx, data)

    // Send: mask email and SSN, redact token for API response
    response, _ := proc.Send(ctx, loaded)
}
```

Four boundaries. Four operations. Tags declare which transforms apply where.

## The Four Boundaries

| Boundary | Operation | Direction | Use Case |
|----------|-----------|-----------|----------|
| **Receive** | `Receive()` | External → App | API requests, webhooks, events |
| **Load** | `Load()` | Storage → App | Database reads, cache hits |
| **Store** | `Store()` | App → Storage | Database writes, cache sets |
| **Send** | `Send()` | App → External | API responses, outbound events |

## Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                           Codec                                 │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                   Processor[T]                           │   │
│  │  ┌──────────────┐   ┌──────────────┐   ┌─────────────┐  │   │
│  │  │ Transforms   │   │    Codec     │   │  Sentinel   │  │   │
│  │  │              │   │              │   │  Metadata   │  │   │
│  │  │  Encryptors  │   │  Marshal()   │   │  (cached)   │  │   │
│  │  │  Hashers     │   │  Unmarshal() │   │             │  │   │
│  │  │  Maskers     │   │              │   │             │  │   │
│  │  └──────────────┘   └──────────────┘   └─────────────┘  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                      Providers                           │   │
│  │   JSON    XML    YAML    MessagePack    BSON            │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

The `Processor[T]` wraps a codec with boundary-aware transforms. Each operation clones the input, applies the appropriate transforms, then encodes or decodes.

## Capabilities

**[Encryption](3.guides/1.encryption.md)** - AES-GCM, RSA-OAEP, envelope encryption. Applied on `store`, reversed on `load`.

**[Hashing](3.guides/1.encryption.md#hashing)** - SHA-256, SHA-512, Argon2, bcrypt. Applied on `receive` for incoming data.

**[Masking](3.guides/2.masking.md)** - Content-aware partial masking. SSN becomes `***-**-6789`. Email becomes `a***@example.com`. Eight built-in patterns.

**[Redaction](5.reference/2.tags.md#redact)** - Full replacement. `send.redact:"[HIDDEN]"` replaces the entire value.

**[Override Interfaces](4.cookbook/1.escape-hatches.md)** - Implement `Encryptable`, `Hashable`, `Maskable`, or `Redactable` to bypass reflection.

## Design Principles

### Boundary Awareness

Different boundaries need different transforms:

```go
type Secret struct {
    // Encrypt when storing, decrypt when loading
    Value string `store.encrypt:"aes" load.decrypt:"aes"`

    // Only mask when sending externally
    Key string `send.mask:"card"`
}
```

### Type Safety

Processors are generic. A `Processor[User]` only accepts `*User` values.

```go
proc, _ := cereal.NewProcessor[User](json.New())
proc.Store(ctx, &user)       // OK
proc.Store(ctx, &otherType)  // Compile error
```

### Non-Destructive

Original values are never modified. The processor clones before transforming.

```go
original := &User{Email: "alice@example.com"}
data, _ := proc.Send(ctx, original)

// original.Email is still "alice@example.com"
// data contains the masked value
```

### Provider Agnostic

Swap codecs without changing your types.

```go
jsonProc, _ := cereal.NewProcessor[User](json.New())
yamlProc, _ := cereal.NewProcessor[User](yaml.New())
bsonProc, _ := cereal.NewProcessor[User](bson.New())

// Same type, same tags, different wire format
```

### Observable

All operations emit signals via capitan for metrics and tracing integration.
